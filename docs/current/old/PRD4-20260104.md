# Epackage Lab B2B 시스템 개선 프로젝트 PRD v4.0

**작성 일자**: 2026-01-04
**버전**: 4.0
**상태**: Task Master AI 파싱 준비 완료
**프로젝트 목적**: 기능 연결 복구 및 비즈니스 플로우 정상화

---

## 📋 EXECUTIVE SUMMARY

### 문제 정의

**코드 리뷰 결과 (2026-01-03)**:
- **총 검토 항목**: 20개
- **Critical**: 3개 (릴리즈 차단)
- **High**: 8개 (주요 기능 고장)
- **Medium**: 7개 (부분 기능 제한)
- **Low**: 2개 (미관/UX)

### 핵심 문제

1. **B2B 시스템 전체 누락** - API 28개는 존재하나 프론트엔드 전무
2. **잘못된 Checkout 플로우** - B2B에 부적합한 B2C 패턴 구현
3. **DEV_MODE 데이터 차단** - 개발 중에 기능 테스트 불가
4. **데이터베이스 연결 누락** - 주요 기능이 하드코딩 데이터 사용

### 목표

**1차 목표 (Phase 1 - 1~2주)**: Critical 문제 해결
**2차 목표 (Phase 2 - 2~3주)**: High 우선순위 해결
**3차 목표 (Phase 3 - 1~2주)**: Medium 우선순위 해결
**4차 목표 (Phase 4 - 1주)**: Low 우선순위 해결

---

## 🔴 CRITICAL ISSUES (즉시 조치 필요)

### [CR-01] B2B 시스템 전체 구현 누락

**위치**: `src/app/b2b/` (비어있음)
**심각도**: Critical
**상태**: 완전히 미구현

**현황**:
```bash
# 프론트엔드 (없음)
src/app/b2b/             # 비어있음

# 백엔드 API (있음)
src/app/api/b2b/login/route.ts              # ✅
src/app/api/b2b/register/route.ts           # ✅
src/app/api/b2b/admin/pending-users/route.ts # ✅
src/app/api/b2b/contracts/route.ts          # ✅
... (총 28개 API 라우트)
```

**API ↔ 프론트엔드 불일치**:

| API 경로 | 프론트엔드 | 상태 |
|---------|----------|------|
| `/api/b2b/login` | ❌ 없음 | 로그인 불가 |
| `/api/b2b/register` | ❌ 없음 | 회원가입 불가 |
| `/api/b2b/quotations` | ❌ 없음 | 견적 관리 불가 |
| `/api/b2b/orders` | ❌ 없음 | 주문 관리 불가 |
| `/api/b2b/contracts` | ❌ 없음 | 계약 관리 불가 |

**해결 방안**:

**옵션 A (완전 구현)**: B2B 전용 페이지 구축
```bash
src/app/b2b/
├── login/
│   └── page.tsx              # B2B 로그인
├── register/
│   └── page.tsx              # B2B 회원가입
├── dashboard/
│   └── page.tsx              # B2B 대시보드
├── quotations/
│   ├── page.tsx              # 견적 목록
│   └── [id]/
│       └── page.tsx          # 견적 상세
├── orders/
│   ├── page.tsx              # 주문 목록
│   └── [id]/
│       └── page.tsx          # 주문 상세
└── contracts/
    ├── page.tsx              # 계약 목록
    └── [id]/
        └── page.tsx          # 계약 상세
```

**수락 기준**:
- [ ] B2B 로그인 페이지 작동
- [ ] B2B 회원가입 페이지 작동
- [ ] B2B 대시보드 표시
- [ ] 견적 관리 기능 작동
- [ ] 주문 관리 기능 작동
- [ ] 계약 관리 기능 작동

**예상 작업량**: 40-60시간

---

### [CR-02] 잘못된 Checkout 플로우 (B2B 부적합)

**위치**: `src/app/checkout/CheckoutClient.tsx`
**심각도**: Critical
**상태**: B2B에 맞지 않는 구조

**문제점**:

**B2B 포장재 사업의 올바른 플로우**:
```
견적 생성 → 견적 승인 → 계약 체결 → 생산/납품 → 청구서 발송 → 고객 은행 송금
```

**현재 잘못된 구현**:
```typescript
// src/app/checkout/CheckoutClient.tsx:830-851
// ⚠️ B2B에 부적합한 카드 결제 UI
const [paymentType, setPaymentType] = useState<'invoice' | 'credit_card' | 'bank_transfer'>('invoice')
```

**구체적인 문제**:
1. **카드 결제 UI 존재**: B2B 포장재 사업에서는 카드 결제를 사용하지 않음
2. **Checkout 페이지 자체가 B2C 패턴**: B2B에 맞지 않는 구조
3. **주문 생성 API 없음**: `setTimeout` 시뮬레이션만 있고 실제 주문 저장 안 됨

**삭제 필요한 파일**:
```
src/app/checkout/page.tsx
src/app/checkout/CheckoutClient.tsx
src/contexts/CheckoutContext.tsx
src/app/order-confirmation/page.tsx
```

**해결 방안**:

1. **Checkout 페이지 삭제**
2. **견적 시스템으로 통합**
   ```
   /quote-simulator 또는 /smart-quote
   → 견적 생성
   → 견적 제출 (API: /api/quotations/create)
   → 관리자 승인 대기
   → 계약 체결 (API: /api/b2b/contracts/sign)
   → 주문 생성 (API: /api/b2b/orders/create)
   → 생산/납품
   → 청구서 발송 (은행 계좌 정보 포함)
   → 고객 은행 송금
   ```

3. **청구서에 은행 정보만 표시**
   ```typescript
   // 청구서/계약서에 포함될 은행 정보
   {
     bankName: "三菱UFJ銀行",
     branch: "本店営業部",
     accountType: "普通",
     accountNumber: "1234567",
     accountHolder: "株式会社Epackage Lab"
   }
   ```

**수락 기준**:
- [ ] Checkout 페이지 삭제 완료
- [ ] 견적 → 주문 플로우 작동
- [ ] 청구서에 은행 계좌 정보 표시
- [ ] 카드 결제 UI 완전 제거

**예상 작업량**: 4-6시간

---

### [CR-03] DEV_MODE로 인한 회원 포털 데이터 미노출

**위치**: `src/lib/dashboard.ts:214-224, 811-833`
**심각도**: Critical
**상태**: 개발 중 기능 테스트 불가

**문제 코드**:
```typescript
// src/lib/dashboard.ts:214-224
export async function getOrders(
  filters?: OrderFilters,
  pagination?: PaginationParams
): Promise<PaginatedResponse<Order>> {
  const userId = await getCurrentUserId();
  if (!userId) throw new Error('Not authenticated');

  // ⚠️ DEV_MODE: 빈 데이터 반환
  if (process.env.NEXT_PUBLIC_DEV_MODE === 'true') {
    console.log('[getOrders] DEV_MODE: Returning empty mock data');
    return {
      data: [],
      total: 0,
      page: pagination?.page || 1,
      limit: pagination?.limit || 20,
      totalPages: 0,
    };
  }

  // ... 실제 Supabase 쿼리
}
```

**동일한 패턴이 적용된 함수**:
| 함수 | 라인 | 문제 |
|-----|------|------|
| `getOrders()` | 214-224 | 주문 내역 미노출 |
| `getQuotations()` | (추정) | 견적 내역 미노출 |
| `getInvoices()` | (추정) | 청구서 미노출 |
| `getDashboardStats()` | 811-833 | 대시보드 통계 미노출 |

**해결 방안**:

**옵션 A: Mock 데이터 제공 (추천)**
```typescript
if (process.env.NEXT_PUBLIC_DEV_MODE === 'true') {
  return {
    data: [
      // 테스트용 주문 데이터 5-10개
      {
        id: '1',
        order_number: 'ORD-2024-001',
        customer_name: 'テスト株式会社A',
        status: 'PROCESSING',
        total_amount: 150000,
        created_at: '2024-01-01',
      },
      {
        id: '2',
        order_number: 'ORD-2024-002',
        customer_name: 'テスト株式会社B',
        status: 'SHIPPED',
        total_amount: 200000,
        created_at: '2024-01-02',
      },
      // ... 더미 데이터
    ],
    total: 10,
    page: pagination?.page || 1,
    limit: pagination?.limit || 20,
    totalPages: 1,
  };
}
```

**옵션 B: Dev DB 사용**
- 개발용 Supabase 프로젝트 별도 사용
- `.env.development`에서 DEV_MODE 제거

**수락 기준**:
- [ ] 개발 환경에서 테스트 데이터 표시
- [ ] 모든 함수가 5-10개 더미 데이터 반환
- [ ] 데이터 형식이 실제 DB와 일치

**예상 작업량**: 2-4시간

---

## 🟠 HIGH PRIORITY ISSUES

### [HI-04] 견적 시스템 데이터베이스 연결 누락

**위치**: `src/components/quote/ImprovedQuotingWizard.tsx`
**심각도**: High
**상태**: UI 완성, DB 저장 미구현

**현황**:
- ✅ 견적 위저드 UI (5단계)
- ✅ 가격 계산 로직
- ✅ 프리뷰 시스템
- ❌ **견적 제출 API**
- ❌ **DB 저장**
- ❌ **주문 변환**

**필요한 API**:
```typescript
// 제안되는 API 구조
POST   /api/quotations/create       // 견적 임시 저장
POST   /api/quotations/submit       // 견적 제출
GET    /api/quotations/{id}         // 견적 조회
PATCH  /api/quotations/{id}         // 견적 수정
POST   /api/quotations/{id}/convert // 주문 변환
```

**해결 방안**:
1. 견적 제출 핸들러 구현
2. Supabase `quotations` 테이블 연결
3. 견적 → 주문 변환 플로우 구현

**수락 기준**:
- [ ] 견적 제출 시 DB 저장
- [ ] 견적 목록 조회
- [ ] 견적에서 주문 변환

**예상 작업량**: 8-12시간

---

### [HI-05] 상품 카탈로그 DB 연결 누락

**위치**: `src/app/api/products/route.ts`
**심각도**: High
**상태**: 하드코딩 데이터 사용

**문제 코드**:
```typescript
// src/app/api/products/route.ts:2-11
import { getAllProducts } from '@/lib/product-data'

export async function GET(request: NextRequest) {
  try {
    const { searchParams } = new URL(request.url)
    const category = searchParams.get('category')
    const locale = searchParams.get('locale') || 'ja'

    // ⚠️ 하드코딩된 데이터 사용
    const products = getAllProducts(category, locale)

    return NextResponse.json({
      success: true,
      data: products,
      count: products.length,
      timestamp: new Date().toISOString()
    })
  }
  // ...
}
```

**데이터 소스**:
- `src/lib/product-data.ts` - **하드코딩된 제품 데이터**
- ❌ Supabase `products` 테이블 미사용

**해결 방안**:
```typescript
// 제안되는 수정
import { createClient } from '@/lib/supabase'

export async function GET(request: NextRequest) {
  const supabase = createClient()

  let query = supabase
    .from('products')
    .select('*')

  if (category) {
    query = query.eq('category', category)
  }

  const { data, error } = await query

  return NextResponse.json({ success: true, data })
}
```

**수락 기준**:
- [ ] 제품 데이터를 Supabase에서 가져오기
- [ ] 검색/필터링 실제 동작
- [ ] 관리자에서 제품 관리 가능

**예상 작업량**: 4-6시간

---

### [HI-06] 회원 주문 내역 Mock 데이터만 표시

**위치**: `src/app/member/orders/history/page.tsx`
**심각도**: High
**상태**: DEV_MODE로 인한 빈 데이터

**연결**: [CR-03]과 동일한 문제
- `src/lib/dashboard.ts:getOrders()` 함수
- DEV_MODE에서 빈 배열 반환

**해결 방안**: [CR-03] 참조

**예상 작업량**: [CR-03]에 포함

---

### [HI-07] 관리자 대시보드 API 오류 핸들링 부재

**위치**: `src/app/admin/dashboard/page.tsx:28`
**심각도**: High
**상태**: API 실패 시 대시보드가 완전히 깨짐

**해결 방안**:
```typescript
useEffect(() => {
  const fetchStats = async () => {
    try {
      const response = await fetch('/api/admin/dashboard/statistics')
      if (!response.ok) throw new Error('Failed to fetch')
      const data = await response.json()
      setStats(data)
    } catch (error) {
      console.error('Dashboard stats error:', error)
      setError('대시보드 데이터를 불러오지 못했습니다.')
      // Fallback UI 표시
    } finally {
      setLoading(false)
    }
  }

  fetchStats()
}, [])
```

**예상 작업량**: 2-3시간

---

## 🔵 DATABASE INTEGRATION REQUIREMENTS

### ⚠️ MANDATORY: Supabase MCP Only

**모든 데이터베이스 작업은 Supabase MCP를 통해서만 수행해야 합니다.**

```yaml
DATABASE_LAYER:
  provider: "Supabase"
  interface: "MCP (Model Context Protocol)"

mcp_tools:
  execute_sql:
    tool: "mcp__supabase-epackage__execute_sql"
    usage: "모든 SELECT, INSERT, UPDATE, DELETE 쿼리"

  apply_migration:
    tool: "mcp__supabase-epackage__apply_migration"
    usage: "DDL 작업 (테이블 생성, 수정)"

  list_tables:
    tool: "mcp__supabase-epackage__list_tables"
    usage: "스키마 확인"

  list_migrations:
    tool: "mcp__supabase-epackage__list_migrations"
    usage: "마이그레이션 버전 관리"

  get_advisors:
    tool: "mcp__supabase-epackage__get_advisors"
    usage: "보안/성능 체크"
```

**사용 예시**:
```typescript
// ✅ 올바른 방법 (Supabase MCP)
import { executeSql } from '@/lib/supabase-mcp'

const orders = await executeSql(`
  SELECT * FROM orders
  WHERE user_id = $1
  ORDER BY created_at DESC
  LIMIT 20
`, [userId])

// ❌ 금지된 방법
import { PrismaClient } from '@prisma/client'  // 사용 금지
import { createClient } from 'postgresql'       // 직접 연결 금지
```

---

## 📋 TASK BREAKDOWN (Task Master AI Compatible)

### Phase 1: Critical (1-2주)

```markdown
[TASK]
id: 1
title: B2B 시스템 전면 구현
priority: CRITICAL
estimated_hours: 40-60
dependencies: []
description: |
  src/app/b2b/ 디렉토리에 28개 기존 API에 대응하는
  프론트엔드 페이지 구현. 모든 DB 작업은 Supabase MCP 사용.

deliverables:
  - src/app/b2b/login/page.tsx
  - src/app/b2b/register/page.tsx
  - src/app/b2b/dashboard/page.tsx
  - src/app/b2b/quotations/page.tsx
  - src/app/b2b/orders/page.tsx
  - src/app/b2b/contracts/page.tsx

acceptance_criteria:
  - B2B 로그인 가능
  - B2B 회원가입 가능
  - 견적 생성/조회 가능
  - 주문 내역 확인 가능
```

```markdown
[TASK]
id: 2
title: Checkout B2B 플로우 변경
priority: CRITICAL
estimated_hours: 4-6
dependencies: []
description: |
  B2C 패턴의 Checkout 페이지 삭제.
  B2B 패턴의 견적-승인-계약-청구 플로우로 변경.
  모든 DB 작업은 Supabase MCP 사용.

files_to_remove:
  - src/app/checkout/page.tsx
  - src/app/checkout/CheckoutClient.tsx
  - src/contexts/CheckoutContext.tsx
  - src/app/order-confirmation/page.tsx

acceptance_criteria:
  - 카드 결제 UI 완전 제거
  - 견적 → 주문 플로우 작동
  - 청구서에 은행 계좌 정보 표시
```

```markdown
[TASK]
id: 3
title: DEV_MODE 데이터 문제 해결
priority: CRITICAL
estimated_hours: 2-4
dependencies: []
description: |
  개발 환경에서도 테스트 가능한 Mock 데이터 제공.
  빈 배열 대신 5-10개 실제 형태의 테스트 데이터 반환.
  모든 데이터는 Supabase MCP에서 가져온 형태와 일치.

target_functions:
  - getOrders()
  - getQuotations()
  - getInvoices()
  - getDashboardStats()

acceptance_criteria:
  - DEV_MODE에서 테스트 데이터 표시
  - 데이터 형식이 실제 DB와 일치
```

### Phase 2: High Priority (2-3주)

```markdown
[TASK]
id: 4
title: 견적 시스템 DB 연결
priority: HIGH
estimated_hours: 8-12
dependencies: [3]
description: |
  ImprovedQuotingWizard UI를 Supabase DB와 연결.
  모든 쿼리는 Supabase MCP의 execute_sql로 실행.
  견적 → 주문 변환 플로우 완성.

apis_to_create:
  - POST /api/quotations/create
  - POST /api/quotations/submit
  - GET  /api/quotations/{id}
  - PATCH /api/quotations/{id}
  - POST /api/quotations/{id}/convert

acceptance_criteria:
  - 견적 제출 시 DB 저장
  - 견적 목록 조회
  - 견적에서 주문 변환
```

```markdown
[TASK]
id: 5
title: 상품 카탈로그 DB 연결
priority: HIGH
estimated_hours: 4-6
dependencies: []
description: |
  하드코딩된 제품 데이터를 Supabase products 테이블로 변경.
  모든 쿼리는 Supabase MCP 사용.
  검색/필터링 기능 실제 동작.

file_to_modify:
  - src/app/api/products/route.ts

acceptance_criteria:
  - 제품 데이터를 Supabase에서 가져오기
  - 검색/필터링 실제 동작
  - 관리자에서 제품 관리 가능
```

```markdown
[TASK]
id: 6
title: 관리자 대시보드 에러 핸들링
priority: HIGH
estimated_hours: 2-3
dependencies: []
description: |
  API 실패 시 대시보드가 완전히 깨지는 문제 해결.
  try-catch 블록 추가 및 Fallback UI 구현.

file_to_modify:
  - src/app/admin/dashboard/page.tsx

acceptance_criteria:
  - API 실패 시 에러 메시지 표시
  - Fallback UI 작동
  - 로딩 상태 처리
```

### Phase 3: Medium Priority (1-2주)

```markdown
[TASK]
id: 7
title: 계정 삭제 기능 구현
priority: MEDIUM
estimated_hours: 3-4
dependencies: []
description: |
  alert만 있는 계정 삭제 기능 실제 구현.
  Supabase auth.user.delete() 사용.

file_to_modify:
  - src/app/member/edit/page.tsx

acceptance_criteria:
  - 계정 삭제 가능
  - 관련 데이터 정리
  - 삭제 확인 이메일 발송
```

```markdown
[TASK]
id: 8
title: 샘플 요청 폼 제출 기능 구현
priority: MEDIUM
estimated_hours: 2-3
dependencies: []
description: |
  임시 저장만 있는 샘플 요청 폼 실제 제출 구현.
  /api/samples/ API 연결.

file_to_modify:
  - src/components/contact/SampleRequestForm.tsx

acceptance_criteria:
  - 폼 제출 시 DB 저장
  - 관리자 알림 발송
```

---

## 🔘 COMPREHENSIVE BUTTON AUDIT (전체 버튼 기능 감사)

### ⚠️ CRITICAL FINDING

**전체 코드베이스 스캔 결과**:
- **총 버튼 수**: **200개 이상**
- **검토 파일**: **88개 파일**
- **검토 일자**: 2026-01-04

### 구현 상태 분류

| 상태 | 비율 | 버튼 수 | 설명 |
|------|------|---------|------|
| **FULLY_IMPLEMENTED** | 15% | ~30개 | API + DB 완전 연결 |
| **PARTIAL_IMPLEMENTED** | 25% | ~50개 | UI만 구현, 백엔드 불완전 |
| **NOT_IMPLEMENTED** | 35% | ~70개 | 버튼만 존재, 핸들러 없음 |
| **PLACEHOLDER** | 25% | ~50개 | TODO/Fake 핸들러 |

---

## 📋 상세 버튼 감사표

### 범례
- **FULLY**: 완전 구현 (API + DB 연결됨)
- **PARTIAL**: 부분 구현 (UI만 있음)
- **NONE**: 미구현 (버튼만 있음)
- **TODO**: 플레이스홀더 (TODO 주석)

---

### 1. PUBLIC PAGES (공개 페이지)

#### 1.1 홈페이지 (`/`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| CTA Section Buttons | `src/components/home/CTASection.tsx` | TODO | - | - | - |
| Product Showcase Links | `src/components/home/ProductShowcaseSection.tsx` | PARTIAL | `/catalog` | - | - |

**구현 완료도**: 20%

---

#### 1.2 카탈로그 (`/catalog`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **상세보기** (Quick View) | `ProductCard.tsx:117-124` | FULLY | Modal | - | ✅ |
| **샘플 요청** | `ProductCard.tsx:34-38` | TODO | - | - | 🔄 TODO 주석 |
| **템플릿 다운로드** | `ProductCard.tsx:40-54` | FULLY | `/templates/` | - | ✅ |
| **필터 적용** | `AdvancedFilters.tsx` | NONE | - | - | ❌ |
| **검색** | `CatalogClient.tsx` | PARTIAL | `/api/products` | ❌ 하드코딩 | ⚠️ |

**구현 완료도**: 40%

**미구현 코드**:
```typescript
// src/components/catalog/ProductCard.tsx:34-38
const handleSampleRequest = useCallback((e: React.MouseEvent) => {
  e.stopPropagation()
  // TODO: Open sample request modal
  console.log('Sample request for:', product.id)
}, [product])
```

---

#### 1.3 문의하기 (`/contact`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **送信する** (전송) | `src/app/contact/page.tsx` | FULLY | `/api/contact` | `contact_submissions` | ✅ |
| **유형 선택** | InquiryTypeSelector | PARTIAL | - | - | ⚠️ |

**구현 완료도**: 80%

---

#### 1.4 견적 시뮬레이터 (`/quote-simulator`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **次へ** (다음) | `ImprovedQuotingWizard.tsx` | PARTIAL | - | - | ⚠️ |
| **戻る** (이전) | `ImprovedQuotingWizard.tsx` | PARTIAL | - | - | ⚠️ |
| **数量を追加** (수량 추가) | `MultiQuantityStep.tsx` | PARTIAL | - | Local State | ⚠️ |
| **削除** (삭제) | `MultiQuantityStep.tsx` | PARTIAL | - | Local State | ⚠️ |
| **PDF 생성** | `EnvelopePreview.tsx` | FULLY | - | - | ✅ |
| **見積作成** (견적 생성) | `ResultStep.tsx` | NONE | - | - | ❌ |

**구현 완료도**: 30%

---

### 2. AUTH PAGES (인증 페이지)

#### 2.1 로그인 (`/auth/signin`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **ログイン** (로그인) | `src/app/auth/signin/page.tsx` | FULLY | Supabase Auth | `users` | ✅ |
| **パスワード忘れ** (비밀번호 찾기) | - | TODO | - | - | 🔄 |
| **新規登録** (회원가입) | Link | FULLY | `/auth/register` | - | ✅ |

**구현 완료도**: 80%

---

#### 2.2 회원가입 (`/auth/register`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **新規登録** (회원가입) | `src/app/auth/register/page.tsx` | FULLY | `/api/auth/register` | `users`, `profiles` | ✅ |
| **B2B 등록** | Link | FULLY | `/b2b/register` | - | ⚠️ 페이지 없음 |

**구현 완료도**: 70%

---

### 3. MEMBER PAGES (회원 포털)

#### 3.1 회원 대시보드 (`/member/dashboard`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **すべて見る** (모두 보기) | `DashboardStatsCard.tsx` | FULLY | Navigation | - | ✅ |
| 통계 카드 링크 | `page.tsx:162-164` | FULLY | Navigation | - | ✅ |

**구현 완료도**: 100%

---

#### 3.2 견적 목록 (`/member/quotations`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **+ 新規見積** (새 견적) | `page.tsx:438-440` | FULLY | Navigation | - | ✅ |
| **フィルター** (필터) | `page.tsx:452-463` | FULLY | `/api/quotations/list` | `quotations` | ✅ |
| **PDF ダウンロード** | `page.tsx:568-576` | FULLY | Client-side | - | ✅ |
| **発注する** (발주) | `page.tsx:532-539` | FULLY | `/api/orders/create` | `orders` | ✅ |
| **詳細を見る** (상세) | `page.tsx:577-579` | NONE | - | - | ❌ |

**구현 완료도**: 80%

---

#### 3.3 주문 목록 (`/member/orders`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **+ 新規見積** (새 견적) | `page.tsx:191-193` | FULLY | Navigation | - | ✅ |
| **フィルター** (필터) | `page.tsx:204-217` | FULLY | Service Client | `orders` | ✅ |
| **詳細を見る** (상세) | `page.tsx:287-290` | NONE | - | - | ❌ |

**구현 완료도**: 66%

---

#### 3.4 샘플 요청 (`/member/samples`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **送信する** (전송) | `SampleRequestForm.tsx:233-253` | FULLY | `/api/samples` | `sample_requests` | ✅ |
| **復元する** (복원) | `SampleRequestForm.tsx:172-178` | FULLY | LocalStorage | - | ✅ |
| **クリア** (클리어) | `SampleRequestForm.tsx:179-185` | FULLY | LocalStorage | - | ✅ |

**구현 완료도**: 100%

---

#### 3.5 프로필 수정 (`/member/edit`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **保存** (저장) | `page.tsx` | PARTIAL | `/api/member/profile` | `profiles` | ⚠️ |
| **アカウント削除** (계정 삭제) | `page.tsx` | NONE | alert only | - | ❌ |

**구현 완료도**: 30%

---

### 4. ADMIN PAGES (관리자 포털)

#### 4.1 관리자 대시보드 (`/admin/dashboard`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **注文管理** (주문 관리) | `QuickActionsWidget.tsx` | FULLY | Navigation | - | ✅ |
| **承認待ち** (승인 대기) | `QuickActionsWidget.tsx` | FULLY | Navigation | - | ✅ |
| **生産管理** (생산 관리) | `QuickActionsWidget.tsx` | FULLY | Navigation | - | ✅ |
| **出荷処理** (출하 처리) | `QuickActionsWidget.tsx` | FULLY | Navigation | - | ✅ |
| **契約管理** (계약 관리) | `QuickActionsWidget.tsx` | FULLY | Navigation | - | ✅ |
| **在庫管理** (재고 관리) | `QuickActionsWidget.tsx` | FULLY | Navigation | - | ✅ |

**구현 완료도**: 100%

---

#### 4.2 회원 승인 (`/admin/approvals`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **承認** (승인) | `page.tsx:420-436` | FULLY | `/api/admin/approve-member` | `profiles` | ✅ |
| **拒否** (거부) | `page.tsx:437-447` | FULLY | `/api/admin/approve-member` | `profiles` | ✅ |
| **更新** (새로고침) | `page.tsx:265-270` | FULLY | GET API | - | ✅ |

**구현 완료도**: 100%

---

#### 4.3 주문 관리 (`/admin/orders`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **ステータス変更** (상태 변경) | `page.tsx:248-265` | FULLY | UPDATE | `orders` | ✅ |
| **一括変更** (일괄 변경) | `page.tsx:80-105` | FULLY | UPDATE | `orders` | ✅ |
| **全選択** (전체 선택) | `page.tsx:119-125` | FULLY | - | - | ✅ |
| **フィルター** (필터) | `page.tsx:152-166` | FULLY | SELECT | `orders` | ✅ |
| **詳細** (상세) | `page.tsx:274-279` | NONE | - | - | ❌ |

**구현 완료도**: 80%

---

#### 4.4 생산 관리 (`/admin/production`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **ステータス更新** (상태 업데이트) | `page.tsx` | PARTIAL | - | `production_jobs` | ⚠️ |
| **詳細** (상세) | - | NONE | - | - | ❌ |

**구현 완료도**: 30%

---

#### 4.5 출하 처리 (`/admin/shipments`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **出荷作成** (출하 생성) | `ShipmentCreateModal.tsx` | PARTIAL | - | `shipments` | ⚠️ |
| **追跡情報更新** (추적 정보 업데이트) | - | NONE | Carrier API | - | ❌ |

**구현 완료도**: 30%

---

#### 4.6 재고 관리 (`/admin/inventory`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **在庫更新** (재고 업데이트) | - | NONE | - | `inventory` | ❌ |
| **入庫記録** (입고 기록) | - | NONE | - | - | ❌ |

**구현 완료도**: 0%

---

#### 4.7 계약 관리 (`/admin/contracts`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **署名依頼送信** (서명 요청) | `SendForSignatureModal.tsx` | PARTIAL | - | - | ⚠️ |
| **契約書ダウンロード** | - | PARTIAL | PDF | - | ⚠️ |

**구현 완료도**: 40%

---

### 5. B2B PAGES (B2B 페이지)

#### 5.1 B2B 로그인 (`/b2b/login`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **ログイン** | - | NONE | - | - | ❌ **페이지 없음** |

**구현 완료도**: 0%

---

#### 5.2 B2B 회원가입 (`/b2b/register`)

| 버튼 라벨 | 위치 | 상태 | API | DB | 코드 라인 |
|----------|------|------|-----|-----|----------|
| **登録** | - | NONE | - | - | ❌ **페이지 없음** |

**구현 완료도**: 0%

---

### 6. COMMON COMPONENTS (공통 컴포넌트)

#### 6.1 내비게이션

| 버튼 라벨 | 위치 | 상태 | API | DB |
|----------|------|------|-----|-----|
| **로그아웃** | Header | FULLY | `/auth/signout` | ✅ |
| **マイページ** | Header | FULLY | `/member/profile` | ✅ |
| **設定** | Header | FULLY | `/member/settings` | ✅ |

**구현 완료도**: 100%

---

## 📊 IMPLEMENTATION STATUS SUMMARY

### 페이지별 구현 현황

| 페이지 구분 | 전체 버튼 | FULLY | PARTIAL | NONE | TODO | 완료도 |
|-----------|----------|-------|---------|------|------|--------|
| **공개 페이지** | ~20 | 8 | 6 | 4 | 2 | 40% |
| **인증 페이지** | ~10 | 7 | 1 | 1 | 1 | 70% |
| **회원 포털** | ~40 | 25 | 5 | 8 | 2 | 62% |
| **관리자 포털** | ~50 | 30 | 8 | 10 | 2 | 60% |
| **B2B 페이지** | ~10 | 0 | 0 | 10 | 0 | 0% |
| **공통 컴포넌트** | ~15 | 10 | 2 | 2 | 1 | 66% |
| **기타 컴포넌트** | ~55 | 5 | 20 | 25 | 5 | 9% |
| **합계** | **~200** | **85** | **42** | **60** | **13** | **42%** |

---

## 🚨 CRITICAL MISSING IMPLEMENTATIONS

### 1. B2B 시스템 (완전 미구현)

| 기능 | 필요 페이지 | API | DB | 상태 |
|------|-----------|-----|-----|------|
| B2B 로그인 | `/b2b/login` | ✅ | ✅ | ❌ 페이지 없음 |
| B2B 회원가입 | `/b2b/register` | ✅ | ✅ | ❌ 페이지 없음 |
| B2B 대시보드 | `/b2b/dashboard` | ✅ | ✅ | ❌ 페이지 없음 |
| B2B 견적 관리 | `/b2b/quotations` | ✅ | ✅ | ❌ 페이지 없음 |
| B2B 주문 관리 | `/b2b/orders` | ✅ | ✅ | ❌ 페이지 없음 |
| B2B 계약 관리 | `/b2b/contracts` | ✅ | ✅ | ❌ 페이지 없음 |

**Task ID**: [CR-01] (이미 정의됨)

---

### 2. 주문 관리 기능

| 버튼 | 위치 | API | DB | 상태 |
|------|------|-----|-----|------|
| **주문 취소** | `/member/orders` | ❌ | ❌ | ❌ |
| **주문 수정** | `/member/orders` | ❌ | ❌ | ❌ |
| **재주문** | `/member/orders` | ❌ | ❌ | ❌ |
| **주문 상세** | `/member/orders/[id]` | - | - | ❌ |

**Task ID**: [HI-06]

---

### 3. 관리자 상세 페이지

| 페이지 | API | DB | 상태 |
|--------|-----|-----|------|
| **주문 상세** | `/admin/orders/[id]` | ❌ | ❌ |
| **생산 상세** | `/admin/production/[id]` | ❌ | ❌ |
| **출하 상세** | `/admin/shipments/[id]` | ❌ | ❌ |

**Task ID**: [TASK-11]

---

### 4. 카탈로그 필터링

| 기능 | API | DB | 상태 |
|------|-----|-----|------|
| **고급 필터** | ❌ | ❌ | ❌ |
| **검색** | ⚠️ 하드코딩 | ❌ | ⚠️ |
| **샘플 요청** | ❌ | ❌ | 🔄 TODO |

**Task ID**: [TASK-12]

---

## 🔧 DATABASE CONNECTION STATUS

### 연결된 테이블

| 테이블 | API | 상태 | 비고 |
|--------|-----|------|------|
| `users` | Supabase Auth | ✅ | 인증 완료 |
| `profiles` | `/api/member/*` | ✅ | 프로필 관리 |
| `contact_submissions` | `/api/contact` | ✅ | 문의하기 |
| `sample_requests` | `/api/samples` | ✅ | 샘플 요청 |
| `quotations` | ⚠️ | ⚠️ | 부분 연결 |
| `orders` | ⚠️ | ⚠️ | 부분 연결 |
| `production_jobs` | ❌ | ❌ | 미연결 |
| `shipments` | ❌ | ❌ | 미연결 |
| `inventory` | ❌ | ❌ | 미연결 |
| `contracts` | ❌ | ❌ | 미연결 |

---

## 📝 TASK MASTER AI TASKS (버튼 관련)

### 추가 태스크 정의

```markdown
[TASK]
id: 14
title: 모든 상세보기 페이지 구현
priority: HIGH
estimated_hours: 20-30
dependencies: [3, 4]
description: |
  회원/관리자 포털의 모든 상세보기 페이지 구현.
  총 6개 페이지 작업.
  모든 DB 작업은 Supabase MCP 사용.

pages_to_create:
  - /member/quotations/[id]/page.tsx
  - /member/orders/[id]/page.tsx
  - /admin/orders/[id]/page.tsx
  - /admin/production/[id]/page.tsx
  - /admin/shipments/[id]/page.tsx
  - /admin/contracts/[id]/page.tsx

acceptance_criteria:
  - 모든 상세보기 페이지 작동
  - 데이터 표시 정확
  - 수정/삭제 기능 작동
```

```markdown
[TASK]
id: 15
title: 주문 관리 기능 버튼 구현
priority: HIGH
estimated_hours: 10-15
dependencies: [4]
description: |
  주문 취소, 수정, 재주문 기능 구현.
  모든 DB 작업은 Supabase MCP 사용.

features:
  - 주문 취소 (status -> cancelled)
  - 주문 수정 (수량, 주소)
  - 재주문 (기존 주문 복사)
  - 주문 내역 PDF 다운로드

acceptance_criteria:
  - 모든 버튼이 기능 연결됨
  - 주문 상태 변경 가능
  - 재주문 시 새 주문 생성
```

```markdown
[TASK]
id: 16
title: 카탈로그 필터링 시스템 구현
priority: MEDIUM
estimated_hours: 8-12
dependencies: [5]
description: |
  고급 필터링, 검색 기능 구현.
  하드코딩 데이터를 DB 연결로 변경.
  모든 DB 작업은 Supabase MCP 사용.

features:
  - 고급 필터 (재료, 사이즈, 마감)
  - 키워드 검색
  - 가격 범위 필터
  - 정렬 기능

acceptance_criteria:
  - 모든 필터가 실제 동작
  - DB에서 데이터 조회
  - 검색 결과 정확
```

```markdown
[TASK]
id: 17
title: 관리자 페이지 기능 완성
priority: HIGH
estimated_hours: 30-40
dependencies: [3]
description: |
  생산, 출하, 재고, 계약 관리 기능 완성.
  현재 0-40% 구현 상태.
  모든 DB 작업은 Supabase MCP 사용.

modules:
  - 생산 관리 (production_jobs)
  - 출하 처리 (shipments)
  - 재고 관리 (inventory)
  - 계약 관리 (contracts)

acceptance_criteria:
  - 모든 CRUD 작동
  - 상태 변경 가능
  - 알림 발송
```

---

## 📊 SUCCESS METRICS

### Phase 1 완료 기준

- [ ] B2B 시스템 3개 핵심 페이지 작동
- [ ] Checkout 삭제, 견적 시스템 통합
- [ ] DEV_MODE에서 테스트 데이터 확인
- [ ] 보안 취약점 0개 (CRITICAL)

### Phase 2 완료 기준

- [ ] 견적 제출 → DB 저장 확인
- [ ] 카탈로그가 DB에서 데이터 가져오기
- [ ] 관리자 대시보드 에러 핸들링
- [ ] 주요 데이터 연결 완료

### 최종 목표

| 항목 | 현재 | 목표 |
|------|------|------|
| B2B 플로우 완성도 | 0% | 100% |
| DB 연결률 | 30% | 95% |
| 개발 생산성 | 40% | 90% |
| 릴리즈 준비 | ❌ | ✅ |

---

## 🛡️ ACCEPTANCE CRITERIA

### 최종 승인 조건

- [ ] 모든 CRITICAL 항목 해결
- [ ] 80% 이상의 HIGH 항목 해결
- [ ] 60% 이상의 MEDIUM 항목 해결
- [ ] 모든 DB 쿼리는 Supabase MCP를 통해서만 수행
- [ ] Prisma/ORM 사용 없음
- [ ] Task Master AI로 파싱 가능한 구조

---

## 📚 REFERENCES

1. [수정사항.md](../수정사항.md) - 사용자 지적 사항
2. [REVIEW_REPORT_2026-01-03.md](../REVIEW_REPORT_2026-01-03.md) - 종합 검토 보고서
3. [PRD.md](./PRD.md) - 기존 PRD v1.0
4. [PRD2-20260102.md](./PRD2-20260102.md) - 기존 PRD v2.0
5. [PRD3-20260102.md](./PRD3-20260102.md) - 기존 PRD v3.0

---

**문서 버전**: 4.0
**최종 수정**: 2026-01-04
**다음 검토**: Phase 1 완료 후

**Task Master AI 파싱을 위한 형식 준수 완료**
