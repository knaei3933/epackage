# フィルム幅に基づく並列印刷価格モデル

> **作成日**: 2026-01-17
> **目的**: フィルム幅と並列生産可能性に基づいた、透明かつ魅力的な価格政策の設計

---

## 1. 基本概念

### 1-1. 新しいアプローチの核心

```
顧客へのメッセージ:
「2本注文すると1本当たりの単価が20%安くなります」
「3本注文すると1本当たりの単価が27%安くなります」
```

**従来との違い**:
| 項目 | 従来（隠された並列生産） | 新モデル |
|------|------------------------|----------|
| 顧客の理解 | 「なぜ価格が同じ？」 | 「2本注文すると安い！」 |
| 価格決定 | 製造者側の都合 | **注文数に基づく明確な割引** |
| 透明性 | 低（並列生産を知らない） | 高（数式で理解可能） |

### 1-2. 原反幅と並列生産可能性

**利用可能な原反幅**:

| 原反幅 | 印刷可能幅 | 有効幅 = 原反 - 20mm |
|--------|-----------|---------------------|
| **590mm** | 570mm | 550mm（両端10mm余白） |
| **760mm** | 740mm | 720mm（両端10mm余白） |

---

## 2. フィルム幅別並列生産マトリクス

### 2-1. 合掌袋（T-shape）・ボックスパウチ（M-shape）

**フィルム幅計算式**:
```
T-shape: フィルム幅 = (W × 2) + 22
M-shape: フィルム幅 = (G + W) × 2 + 32
```

| パウチ幅 (W) | T-shape フィルム幅 | 590mm原反で並列可能 | 760mm原反で並列可能 | 推奨注文数 |
|-------------|-------------------|-------------------|-------------------|-----------|
| 100mm | 222mm | 2本（550÷222） | 3本（720÷222） | **3本注文で27%OFF** |
| 120mm | 262mm | 2本 | 2本 | **2本注文で20%OFF** |
| 150mm | 322mm | 1本 | 2本 | **2本注文で20%OFF** |
| 180mm | 382mm | 1本 | 1本 | 1本のみ |
| 200mm | 422mm | 1本 | 1本 | 1本のみ |
| 220mm | 462mm | 1本 | 1本 | 1本のみ |
| 250mm | 522mm | 1本 | 1本 | 1本のみ |
| 280mm | 582mm | × | 1本 | 1本のみ |

### 2-2. ロールフィルム

**フィルム幅 = 指定幅（そのまま）**

| ロール幅 | 590mm原反で並列可能 | 760mm原反で並列可能 | 推奨注文数 |
|---------|-------------------|-------------------|-----------|
| 100mm | 5本 | 7本 | **5本以上で大幅割引** |
| 120mm | 4本 | 6本 | **4本以上で大幅割引** |
| 150mm | 3本 | 4本 | **3本以上で30%OFF** |
| 180mm | 3本 | 4本 | **3本以上で30%OFF** |
| 200mm | 2本 | 3本 | **3本注文で27%OFF** |
| 250mm | 2本 | 2本 | **2本注文で20%OFF** |
| 300mm | 1本 | 2本 | **2本注文で20%OFF** |
| 350mm | 1本 | 2本 | **2本注文で20%OFF** |

### 2-3. 平袋・スタンドアップ（2列印刷）

**2列フィルム幅計算**:
```
平袋: (H × 4) + 71
スタンド: (H × 4) + G + 40
```

| パウチ縦 (H) | 平袋2列幅 | 590mmで2列可能 | 760mmで2列可能 | 効率改善 |
|-------------|-----------|---------------|---------------|---------|
| 80mm | 391mm | ○ | ○ | **2列生産でコスト半減** |
| 100mm | 471mm | ○ | ○ | **2列生産でコスト半減** |
| 120mm | 551mm | ○ | ○ | **2列生産でコスト半減** |
| 130mm | 591mm | × | ○ | **760mm使用で2列可能** |
| 150mm | 671mm | × | × | 1列のみ |

---

## 3. 新価格モデル設計

### 3-1. 注文数ベースの割引構造

```
基本単価 = 1本注文時の単価
```

| 注文数 | 割引率 | 顧客へのメッセージ |
|--------|--------|------------------|
| 1本 | 0%（基準） | 標準価格 |
| 2本 | 20%OFF | **2本注文で20%お得！** |
| 3本 | 30%OFF | **3本注文で30%お得！** |
| 4本 | 35%OFF | **4本注文で35%お得！** |
| 5本以上 | 40%OFF | **5本以上で40%お得！** |

### 3-2. 実装アルゴリズム

```typescript
/**
 * フィルム幅に基づく最大並列数を計算
 */
function calculateMaxParallelCount(
  filmWidthMM: number,
  materialWidth: 590 | 760 = 590
): number {
  const effectiveWidth = materialWidth - 20; // 両端10mm余白
  return Math.floor(effectiveWidth / filmWidthMM);
}

/**
 * 注文数に基づく割引率を計算
 */
function calculateVolumeDiscount(orderCount: number): number {
  const discountTable = {
    1: 0.00,   // 0%
    2: 0.20,   // 20%
    3: 0.30,   // 30%
    4: 0.35,   // 35%
    5: 0.40    // 40%
  };
  return discountTable[Math.min(orderCount, 5)] ?? 0.40;
}

/**
 * 最適注文提案を生成
 */
function generateOptimalOrderProposal(
  filmWidthMM: number,
  requestedLength: number
): OrderProposal[] {
  const proposals: OrderProposal[] = [];

  // 590mm原反での提案
  const maxParallel590 = calculateMaxParallelCount(filmWidthMM, 590);
  for (let count = 1; count <= Math.min(maxParallel590, 5); count++) {
    const discount = calculateVolumeDiscount(count);
    proposals.push({
      materialWidth: 590,
      orderCount: count,
      totalLength: requestedLength * count,
      discountRate: discount,
      perUnitSavings: discount * 100,
      recommended: count >= 2 && maxParallel590 >= count
    });
  }

  // 760mm原反での提案（590mmより効率が良い場合）
  const maxParallel760 = calculateMaxParallelCount(filmWidthMM, 760);
  if (maxParallel760 > maxParallel590) {
    for (let count = maxParallel590 + 1; count <= Math.min(maxParallel760, 5); count++) {
      const discount = calculateVolumeDiscount(count);
      proposals.push({
        materialWidth: 760,
        orderCount: count,
        totalLength: requestedLength * count,
        discountRate: discount,
        perUnitSavings: discount * 100,
        recommended: true
      });
    }
  }

  return proposals.sort((a, b) => b.discountRate - a.discountRate);
}
```

### 3-3. UI表示例

```
┌─────────────────────────────────────────────────────────────┐
│  ロールフィルム見積もり: 幅200mm × 500m                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  💡 お得なご提案                                           │
│                                                             │
│  ┌──────────────────────────────────────────────────────┐  │
│  │ ⭐ 推奨: 3本セット                                 │  │
│  │                                                      │  │
│  │  590mm原反使用で3本同時生産可能                     │  │
│  │                                                      │  │
│  │  注文内容: 200mm × 500m × 3本                       │  │
│  │  合計長さ: 1,500m                                    │  │
│  │                                                      │  │
│  │  通常価格: ¥150,000（¥100,000 × 3本）              │  │
│  │  お得価格: ¥105,000                                  │  │
│  │  お得額: -¥45,000（30% OFF）                        │  │
│  │  1本あたり: ¥35,000（通常¥50,000）                  │  │
│  │                                                      │  │
│  │  [この提案で見積もる] ボタン                          │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                             │
│  他のご提案                                                 │
│                                                             │
│  ┌──────┬────────┬──────────┬────────┬──────────┐          │
│  │ 本数 │ 合計長さ │ 通常価格  │ 割引率 │ お得価格 │          │
│  ├──────┼────────┼──────────┼────────┼──────────┤          │
│  │  1本 │  500m  │ ¥100,000 │   -    │ ¥100,000 │          │
│  │  2本 │ 1,000m │ ¥200,000 │ 20% OFF│ ¥160,000 │          │
│  │  3本 │ 1,500m │ ¥300,000 │ 30% OFF│ ¥210,000 │ ⭐     │
│  └──────┴────────┴──────────┴────────┴──────────┘          │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 4. パウチタイプ別の最適提案ロジック

### 4-1. 合掌袋（T-shape）

```typescript
function getTShapeOptimalProposal(width: number, quantity: number) {
  const filmWidth = (width * 2) + 22;
  const maxParallel590 = Math.floor(550 / filmWidth);
  const maxParallel760 = Math.floor(720 / filmWidth);

  const proposals = [];

  // 590mm原反での提案
  if (maxParallel590 >= 2) {
    proposals.push({
      title: "590mm原反で並列生産",
      maxOrderCount: maxParallel590,
      recommendedOrders: generateOrderOptions(maxParallel590),
      savings: "20-30%"
    });
  }

  // 760mm原反でより効率的な場合
  if (maxParallel760 > maxParallel590) {
    proposals.push({
      title: "760mm原反で効率化（推奨）",
      maxOrderCount: maxParallel760,
      recommendedOrders: generateOrderOptions(maxParallel760),
      savings: "30-40%",
      recommended: true
    });
  }

  // 並列生産不可の場合
  if (maxParallel590 === 1 && maxParallel760 === 1) {
    proposals.push({
      title: "標準生産",
      message: "このサイズは並列生産の対象外です",
      savings: "-"
    });
  }

  return proposals;
}
```

### 4-2. 平袋・スタンドアップ（2列印刷）

```typescript
function getTwoColumnProposal(height: number, depth: number, pouchType: 'flat' | 'stand') {
  // 2列フィルム幅計算
  const filmWidth2Col = pouchType === 'flat'
    ? (height * 4) + 71
    : (height * 4) + depth + 40;

  const canUse590 = filmWidth2Col <= 570;
  const canUse760 = filmWidth2Col <= 740;

  if (canUse590 || canUse760) {
    return {
      twoColumnAvailable: true,
      materialWidth: canUse760 ? 760 : 590,
      message: `2列生産可能！コスト約50%削減`,
      recommended: "2列生産で同一デザインを大量生産"
    };
  }

  return {
    twoColumnAvailable: false,
    message: "1列生産のみ対応"
  };
}
```

---

## 5. 価格計算式

### 5-1. 1本あたりの基本価格

```
基本価格 = 材料費 + 印刷費 + 加工費 + 関税 + 配送料
```

### 5-2. 注文数割引適用後価格

```
割引率 = f(注文数)
  1本: 0%
  2本: 20%
  3本: 30%
  4本: 35%
  5本以上: 40%

割引後基本価格 = 基本価格 × (1 - 割引率) × 注文数
```

### 5-3. 最終価格

```
最終価格 = 割引後基本価格 × 販売マージン(1.2) × 為替レート(0.12)
```

---

## 6. 具体例

### 6-1. ロールフィルム 200mm × 500m

| 注文数 | 基本価格合計 | 割引 | 割引後価格 | 1本あたり | 割引率 |
|--------|-------------|------|-----------|-----------|--------|
| 1本 | ¥100,000 | - | ¥100,000 | ¥100,000 | 0% |
| 2本 | ¥200,000 | ¥40,000 | ¥160,000 | ¥80,000 | **20%** |
| 3本 | ¥300,000 | ¥90,000 | ¥210,000 | ¥70,000 | **30%** ⭐ |
| 4本 | ¥400,000 | ¥140,000 | ¥260,000 | ¥65,000 | **35%** |

**590mm原反で3本並列生産可能（550÷200 = 2.75 → 2本、760mmなら3本）**

### 6-2. 合掌袋 120mm × 180mm（500個）

| パラメータ | 値 |
|-----------|-----|
| フィルム幅 | 262mm |
| 590mm原反最大並列 | 2本（550÷262） |
| 760mm原反最大並列 | 2本（720÷262） |

| 注文数 | 総数量 | 基本価格合計 | 割引 | 割引後価格 | 割引率 |
|--------|--------|-------------|------|-----------|--------|
| 1デザイン | 500個 | ¥150,000 | - | ¥150,000 | 0% |
| 2デザイン | 1,000個 | ¥300,000 | ¥60,000 | ¥240,000 | **20%** ⭐ |

### 6-3. 平袋 80mm × 120mm（5,000個）

| パラメータ | 値 |
|-----------|-----|
| 2列フィルム幅 | 391mm |
| 590mm原反で2列可能 | ○（391 < 570） |
| 効率改善 | **約50%コスト削減** |

| 注文数 | 総数量 | 生産方法 | 基本価格 | 割引後価格 | 効率 |
|--------|--------|----------|----------|-----------|------|
| 5,000個 | 5,000個 | 1列 | ¥200,000 | ¥200,000 | 基準 |
| 5,000個 | 5,000個 | 2列 | ¥100,000 | ¥100,000 | **50% OFF** ⭐ |

---

## 7. 実装要件

### 7-1. 新規コンポーネント

```typescript
// src/components/quote/ParallelProductionProposal.tsx

interface ProposalCardProps {
  filmWidth: number;
  materialWidth: 590 | 760;
  maxParallelCount: number;
  orderOptions: OrderOption[];
  onSelect: (option: OrderOption) => void;
}

interface OrderOption {
  orderCount: number;        // 注文数（本数）
  totalQuantity: number;     // 総数量
  discountRate: number;      // 割引率
  originalPrice: number;     // 通常価格
  discountedPrice: number;   // 割引後価格
  perUnitPrice: number;      // 1本あたり価格
  savings: number;           // お得額
  recommended: boolean;      // 推奨かどうか
}
```

### 7-2. APIエンドポイント

```typescript
// src/app/api/quote/parallel-options/route.ts

interface ParallelOptionsRequest {
  pouchType: string;
  dimensions: { width: number; height: number; depth?: number };
  requestedQuantity: number;
  requestedLength?: number;  // ロールフィルム用
}

interface ParallelOptionsResponse {
  filmWidth: number;
  availableOptions: ParallelOption[];
  bestOption: ParallelOption;
}
```

### 7-3. 計算ライブラリ拡張

```typescript
// src/lib/parallel-pricing.ts

export class ParallelProductionPricing {
  /**
   * パウチタイプに基づく最適並列数を計算
   */
  calculateOptimalParallelCount(
    pouchType: string,
    dimensions: PouchDimensions
  ): ParallelProductionAnalysis {
    // 実装...
  }

  /**
   * 注文数別の価格プロポーザルを生成
   */
  generatePriceProposals(
    basePrice: number,
    maxParallelCount: number
  ): PriceProposal[] {
    // 実装...
  }
}
```

---

## 8. UI/UXデザイン

### 8-1. 見積もりフロー

```
┌─────────────────────────────────────────────────────────────┐
│  Step 1: 基本仕様入力                                       │
│  - パウチタイプ、サイズ、素材                               │
├─────────────────────────────────────────────────────────────┤
│  Step 2: 数量入力                                           │
│  - SKU数、各SKUの数量                                      │
├─────────────────────────────────────────────────────────────┤
│  Step 3: 💡 お得提案表示（NEW）                            │
│  - 「2本注文で20% OFF」                                    │
│  - 「3本注文で30% OFF」⭐推奨                             │
│  - 選択した提案をカートに追加                              │
├─────────────────────────────────────────────────────────────┤
│  Step 4: お見積もり確定                                     │
└─────────────────────────────────────────────────────────────┘
```

### 8-2. 提案カードデザイン

```typescript
// 推奨提案カード（強調表示）
<div className="border-2 border-green-500 bg-green-50 rounded-lg p-6">
  <div className="flex items-center gap-2 mb-4">
    <Star className="text-green-600" />
    <h3 className="text-lg font-bold">推奨: 3本セット</h3>
  </div>

  <div className="space-y-3">
    <div className="flex justify-between">
      <span>注文内容:</span>
      <span className="font-medium">200mm × 500m × 3本</span>
    </div>
    <div className="flex justify-between">
      <span>合計長さ:</span>
      <span className="font-medium">1,500m</span>
    </div>
    <hr />
    <div className="flex justify-between text-red-600">
      <span>お得額:</span>
      <span className="font-bold">-¥45,000 (30% OFF)</span>
    </div>
    <div className="flex justify-between text-lg">
      <span>お得価格:</span>
      <span className="font-bold">¥105,000</span>
    </div>
    <div className="text-sm text-gray-600">
      1本あたり: ¥35,000（通常¥50,000）
    </div>
  </div>

  <button className="w-full mt-4 bg-green-600 text-white py-3 rounded-lg font-medium">
    この提案で見積もる
  </button>
</div>
```

---

## 9. マーケティングメッセージ

### 9-1. ランディングページ

```
【並列生産でコスト削減】

お客様が注文数を増やすほど、1個あたりの単価が下がります！

2本注文 → 20% OFF
3本注文 → 30% OFF
4本注文 → 35% OFF
5本以上 → 40% OFF

※ フィルム幅に応じた最大並列数が適用されます
```

### 9-2 見積もり画面

```
💡 お得なご提案

590mm原反使用で3本同時生産可能

同じロールフィルムを3本ご注文で30%お得！

通常: ¥150,000
お得: ¥105,000
お得: -¥45,000
```

---

## 10. 移行計画

### 10-1. フェーズ1: 計算エンジン開発（1週間）

- [ ] `parallel-pricing.ts` モジュール実装
- [ ] フィルム幅計算ロジック拡張
- [ ] 割引率テーブル実装
- [ ] ユニットテスト

### 10-2. フェーズ2: UI開発（1週間）

- [ ] `ParallelProductionProposal` コンポーネント
- [ ] 提案カードデザイン
- [ ] 選択インタラクション
- [ ] レスポンシブ対応

### 10-3: フェーズ3: 統合（1週間）

- [ ] 見積もりウィザードへの統合
- [ ] APIエンドポイント実装
- [ ] E2Eテスト

### 10-4: フェーズ4: デプロイ（1週間）

- [ ] ステージング環境
- [ ] 本番環境
- [ ] モニタリング

---

## 11. 成功指標

### 11-1 KPI

| 指標 | 目標 | 計測方法 |
|------|------|----------|
| 平均注文数 | +30% | 注文データ分析 |
| 顧客満足度 | +15% | アンケート |
| 見積もり成約率 | +20% | コンバージョン追踪 |
| 利益率維持 | 55%±5% | 財務データ |

### 11-2 A/Bテスト

| バージョン | 説明 |
|-----------|------|
| A（旧） | 従来の並列生産オプション（隠されたコスト削減） |
| B（新） | 注文数ベースの明確な割引表示 |

---

## 12. まとめ

### 12-1 新モデルのメリット

**顧客にとって**:
- ✅ 「3本注文すると30% OFF」の直感的な理解
- ✅ 注文数を増やすほど得をする透明な構造
- ✅ フィルム幅による最適提案が自動表示
- ✅ 複雑な並列生産の知識が不要

**製造者にとって**:
- ✅ 並列生産の能力を最大活用
- ✅ 注文数増加による収益向上
- ✅ 生産計画の効率化
- ✅ 適正な利益率維持

### 12-2 次のステップ

1. 計算エンジンの仕様確定
2. UIプロトタイプ作成
3. 内部レビュー
4. 開発開始

---

**作成日**: 2026-01-17
**バージョン**: 1.0
**ステータス**: 仕様検討中
